<section class='invoices' data-test-invoices>
  <h2>Invoice History</h2>
  <div class='flex flex--wrap flex--space-between'>
    <p class='margin-top-0' data-test-help-text>
      <SvgImage @name="icon-help" @class="icon-help" />
      Having trouble with your invoices?
      <LinkTo @route="help" @query={{hash anchor="form"}}>
        We’re happy to help
      </LinkTo>
    </p>
    <TravisForm as |Form|>
      <div class='form-elem invoice-select-year'>
        <Form.field
          data-test-invoice-select-year
          @value={{year}}
          class='margin-top-0'
          @onChange={{action (mut year)}}
          @showValidationStatusIcons={{false}} as |Field|
        >
          <Field.select
            @searchEnabled={{false}}
            @options={{invoiceYears}} as |year|
          >
            {{year}}
          </Field.select>
        </Form.field>
      </div>
    </TravisForm>      
  </div>
  <div class='invoice-table'>
    <table>
      <thead>
        <tr data-test-table-header-row>
          <th> invoice date </th>
          <th> payment card </th>
          <th> total </th>
          <th> download </th>
        </tr>
      </thead>
      <tbody>
        {{#each (sort-by 'createdAt:desc' selectedInvoices) as |invoice|}}
          <tr data-test-invoice class="fade-in">
            <td>
              {{svg-jar 'icon-invoice' class='icon-invoice'}}
              <span class="invoice-date">
                {{moment-format invoice.createdAt 'MMMM DD, YYYY'}}
              </span>
            </td>
            <td> •••• •••• •••• {{subscription.creditCardInfo.lastDigits}} </td>
            <td> {{format-currency invoice.amountDue fixed=true}} </td>
            <td>
              <a data-test-invoice-url href={{invoice.url}}>
                <EmberTooltip>
                  {{moment-format invoice.createdAt 'MMMM'}} invoice
                </EmberTooltip>
                {{svg-jar 'icon-download' class='icon icon-download'}}
              </a>
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</section>
